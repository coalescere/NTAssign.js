"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function getRBMParameters(e,t){var r=function a(e,t){_classCallCheck(this,a),this.a=e,this.b=t};switch(t){case 0:switch(e){case 0:case 1:return new r(204,27);case 2:return new r(200,26);default:return new r(228,0)}case 1:return new r(235.9,5.5);case 2:return new r(217.8,15.7);case 3:return new r(227,.3);case 4:return new r(223.5,12.5);case 5:return new r(218,18.3);default:throw new Error("invalid type")}}function wRBM2Dt(e,t,r){var a=getRBMParameters(t,r);return a.a/(e-a.b)}function dt2RBM(e,t,r){var a=getRBMParameters(t,r);return a.a/e+a.b}function getEnergyFromCos3Theta(e,t,r,a,n){var l=void 0;if(isMetal(r)&&n>0)throw new Error("mod should be in accordance with p");if(a<=2){if(r>=9)throw new Error("higher than S66 not available");var s=-type0Params[r][0]/(e*e)+2*type0Params[r][1]/(e*e*e);if(s>0)throw new Error("dt");l=isMetal(r)?type0Params[r][0]/e-type0Params[r][1]/(e*e)+type0Params[r][2]/(e*e)*t*(2*n+1):type0Params[r][0]/e-type0Params[r][1]/(e*e)+type0Params[r][2]/(e*e)*t*(r%3===n%2?-1:1),l-=1===a?.04:2===a?.1:0}else if(3===a){if(r>=6)throw new Error("higher than M22 not available for Super-Growth");var i=1.074,o=.467,p=.812,u=function(a){return i*(r+1)/e*(1+o*Math.log10(p/((r+1)/e)))+type3Params[r][a]/(e*e)*t+(r>2?.059*(r+1)/e:0)};l=u(isMetal(r)?n+1:n-1)}else{if(4!==a&&5!==a)throw new Error("invalid type");if(0===r)l=1/(.127+.8606*e)+(1===n?.04575:-.08802)/(e*e)*t;else{if(1!==r)throw new Error("only S11 and S22 are available for SDS-dispersed or ssDNA dispersed");l=1/(.1174+.4644*e)+(1===n?-.1829:.1705)/(e*e)*t}l-=5===a?.02:0}return l}function getCos3Theta(e,t,r,a){var n=[-1,-1];if(a<=2){if(r>=9)throw new Error("higher than S66 not available");e+=1===a?.04:2===a?.1:0,isMetal(r)?(n[0]=(type0Params[r][0]/t-type0Params[r][1]/(t*t)-e)/type0Params[r][2]*(t*t),n[1]=-(type0Params[r][0]/t-type0Params[r][1]/(t*t)-e)/type0Params[r][2]*(t*t)):(n[0]=-(type0Params[r][0]/t-type0Params[r][1]/(t*t)-e)/type0Params[r][2]*(t*t)*(r%3===1?-1:1),n[1]=-(type0Params[r][0]/t-type0Params[r][1]/(t*t)-e)/type0Params[r][2]*(t*t)*(r%3===0?-1:1))}else if(3===a){if(r>=6)throw new Error("higher than M22 not available for Super-Growth");var l=1.074,s=.467,i=.812,o=function(a){return(e-l*(r+1)/t*(1+s*Math.log10(i/((r+1)/t)))-(r>2?.059*(r+1)/t:0))/type3Params[r][a]*(t*t)};n[0]=o(0),n[1]=o(1)}else{if(4!==a&&5!==a)throw new Error("invalid type");if(e+=5===a?.02:0,0===r)n[0]=(e-1/(.127+.8606*t))/.04575*(t*t),n[1]=(e-1/(.127+.8606*t))/-.08802*(t*t);else{if(1!==r)throw new Error("only S11 and S22 are available for SDS-disp. or ssDNA disp.");n[0]=(e-1/(.1174+.4644*t))/-.1829*(t*t),n[1]=(e-1/(.1174+.4644*t))/.1705*(t*t)}}return n[0]=parseFloat(n[0].toFixed(4)),n[1]=parseFloat(n[1].toFixed(4)),(n[0]>1||n[0]<0)&&(n[0]=-1),(n[1]>1||n[1]<0)&&(n[1]=-1),n}function getAverage(e,t,r,a){var n=1.5,l=wRBM2Dt(t,r,a);if(isMetal(r+1))throw new Error("p should be the smaller one");if(!(a<=2)){if(3===a){var s=1.074,i=.467,o=.812,p=function(e){return s*(e+1)/l*(1+i*Math.log10(o/((e+1)/l)))+(e>2?.059*(e+1)/l:0)};if(isMetal(r)){var u=e*l*l/(type3Params[r][1]-type3Params[r][0]);return u<0||u>n?null:(getEnergyFromCos3Theta(l,u,r,a,-1)+getEnergyFromCos3Theta(l,u,r,a,0))/2}var m=r+1,c=1;if(r>=6)throw new Error("higher than M22 not available for Super-Growth");var h=(e+p(r)-p(m))*l*l/(type3Params[m][c-1]-type3Params[r][c-1]);return(h<0||h>n)&&(c=2,h=(e+p(r)-p(m))*l*l/(type3Params[m][c-1]-type3Params[r][c-1])),h<0||h>n?null:(getEnergyFromCos3Theta(l,h,m,a,c)+getEnergyFromCos3Theta(l,h,r,a,c))/2}if(4===a||5===a){if(0!==r)throw new Error("only S11 and S22 are available for SDS-disp. or ssDNA disp.");var d=1,v=(e-(1/(.1174+.4644*l)-1/(.127+.8606*l)))*l*l/(-.1829-.04575);return(v>n||v<0)&&(d=2,v=(e-(1/(.1174+.4644*l)-1/(.127+.8606*l)))*l*l/.25852),v>n||v<0?null:(getEnergyFromCos3Theta(l,v,1,a,d)+getEnergyFromCos3Theta(l,v,0,a,d))/2}throw new Error("invalid type")}if(r>=9)throw new Error("higher than S66 not available");if(isMetal(r)){var f=l*l*e/2*type0Params[r][2];if(f<0||f>n)return null;try{return(getEnergyFromCos3Theta(l,f,r,a,-1)+getEnergyFromCos3Theta(l,f,r,a,0))/2}catch(g){if("dt"===g.message)return null;throw g}}else{var b=r+1,y=function(e){return type0Params[b][e]-type0Params[r][e]},P=1,w=(e*l*l-y(0)*l+y(1))/(type0Params[b][2]*(b%3===P%2?-1:1)-type0Params[r][2]*(r%3===P%2?-1:1));if(w<0&&(P=2,w=-w),w>n)return null;try{return(getEnergyFromCos3Theta(l,w,b,a,P)+getEnergyFromCos3Theta(l,w,r,a,P))/2}catch(g){if("dt"===g.message)return null;throw g}}}function getList(e,t){var r=[],a=5,n=50;if(isMetal(e))for(var l=a;l<n;l++)for(var s=0;s<=l&&!(2*l+s>seriesThreshold);s++)try{if(isMetal(l,s)){var i=getEnergy(Dt(l,s,t),Theta(l,s),e,t,-1),o=getEnergy(Dt(l,s,t),Theta(l,s),e,t,0);r.push([l,s,(o+i)/2,o-i])}}catch(p){if("dt"!==p.message)throw p}else{if(isMetal(e+1))throw new Error("p should be the smaller one, e.g. S11 rather than S22");for(var u=a;u<n;u++)for(var m=0;m<=u&&!(2*u+m>seriesThreshold);m++)try{if(!isMetal(u,m)){var c=getEnergy(Dt(u,m,t),Theta(u,m),e,t,Mod(u,m)),h=getEnergy(Dt(u,m,t),Theta(u,m),e+1,t,Mod(u,m));r.push([u,m,(h+c)/2,h-c])}}catch(p){if("dt"!==p.message)throw p}}return r}function getRBMArray(e,t){var r={rbmLabel:[],rbm:[]},a=60,n=70,l=350;if(!isMetal(e)&&isMetal(e+1))throw new Error("p should be the smaller one, e.g. S11 rather than S22");for(var s=n;s<=l;s+=10){var i=wRBM2Dt(s,e,t),o=[];try{if(isMetal(e)){var p=getEnergyFromCos3Theta(i,a,e,t,0),u=getEnergyFromCos3Theta(i,a,e,t,-1);o.push([(p+u)/2,p-u]),p=getEnergyFromCos3Theta(i,-a,e,t,0),u=getEnergyFromCos3Theta(i,-a,e,t,-1),o.push([(p+u)/2,p-u]),r.rbmLabel.push(s),r.rbm.push(o)}else{var m=getEnergyFromCos3Theta(i,a,e+1,t,1),c=getEnergyFromCos3Theta(i,a,e,t,1);o.push([(m+c)/2,m-c]),m=getEnergyFromCos3Theta(i,0,e+1,t,2),c=getEnergyFromCos3Theta(i,0,e,t,2),o.push([(m+c)/2,m-c]),m=getEnergyFromCos3Theta(i,a,e+1,t,2),c=getEnergyFromCos3Theta(i,a,e,t,2),o.push([(m+c)/2,m-c]),r.rbmLabel.push(s),r.rbm.push(o)}}catch(h){if("dt"===h.message)break;throw h}}return r}function getPlotParams(e){var t=function(e){return e.split(".")[1].length};if(isUnparsable(e.val1)&&isUnparsable(e.val2))throw new Error("Unauthorized Access");if(isUnparsable(e.val1)||isUnparsable(e.val2)){if(isUnparsable(e.rbm))throw new Error("Unauthorized Access");return e.uncertainty=2/Math.pow(10,t(isUnparsable(e.val1)?e.val2:e.val1)),E1R1(e)}return e.uncertainty=2/Math.pow(10,Math.min(t(e.val1),t(e.val2))),E2(e)}function E1R1(e){var t=isUnparsable(e.val1)?e.p2:e.p1,r=e.type,a=p1ToP(t),n=parseFloat(isUnparsable(e.val1)?e.val2:e.val1),l=parseFloat(e.rbm),s=wRBM2Dt(l,a,r),i=getCos3Theta(n,s,a,r),o="",p=function(){return Assign({bluePoint:null,point:[n,.23],pLesser:pToLesser(a),type:r,pointType:"none",p1Lesser:p1ToLesser(t),resultString:o,uncertainty:2e-4})};if(i[0]===-1&&i[1]===-1)return o+="Invalid input: out of range.",p();var u=void 0,m=void 0;if(isMetal(a)){if(t%4-3!==(i[0]===-1?0:-1))return o+="Invalid input: You may have mistaken "+p1Name[t+5-t%4*2]+" for "+p1Name[t]+".",p();u=a,m=i[0]===-1?-1:0}else u=isMetal(a+1)?a-1:a+1,m=i[0]===-1?2:1;var c=void 0;try{c=getEnergyFromCos3Theta(s,i[0]===-1?i[1]:i[0],u,r,m)}catch(h){if("dt"===h.message)return o+="Invalid input: out of range, diameter too small.",p();throw h}if(isMetal(a)&&m===-1||!isMetal(a)&&a>u){var d=[u,a];a=d[0],u=d[1];var v=[c,n];n=v[0],c=v[1]}var f=(n+c)/2,g=c-n;return Assign({bluePoint:null,point:[f,g],pLesser:a,type:r,pointType:"green",p1Lesser:p1ToLesser(t),resultString:o,uncertainty:e.uncertainty},m)}function E2(e){var t="",r=e.p1,a=e.p2,n=e.type,l=parseFloat(e.val1),s=parseFloat(e.val2),i=p1ToP(r),o=p1ToP(a),p=e.rbm;if(r>a){var u=[o,i];i=u[0],o=u[1];var m=[s,l];l=m[0],s=m[1];var c=[a,r];r=c[0],a=c[1]}if(isMetal(o)!==isMetal(i))throw new Error("invalid form submission");if(a-r===1){var h=null;if(!isUnparsable(p)){var d=getAverage(s-l,parseFloat(p),i,n);null!==d?h=[d,s-l]:t+="Invalid input: RBM value out of range. Only transition energies are processed. <br/ >"}return Assign({point:[(l+s)/2,s-l],pLesser:i,type:n,pointType:"red",bluePoint:h,p1Lesser:r,resultString:t,uncertainty:e.uncertainty})}}function Assign(e){function t(e,t,r,a){l=e,s=t,i=r,o=a}function r(){e.result=d.orderBy(u).toArray();for(var t=0;t<e.result.length;t++)e.resultString+="\n        <b>("+Math.round(e.result[t][0])+","+Math.round(e.result[t][1])+")</b>\n        "+(t!==e.result.length-1?", ":"");e.resultString+="</span>"}var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.uncertainty,l=-1,s=-1,i=-1,o=-1,p=function(e,t,r,a){return Math.sqrt((e-r)*(e-r)+(t-a)*(t-a)*25)},u=function(t){return p(t[2],t[3],e.point[0],e.point[1])},m=.6,c=isMetal(e.pLesser)?.6:e.point[1]+.6,h=isMetal(e.pLesser)?-.1:e.point[1]-.6;e.all=Enumerable.from(getList(e.pLesser,e.type)).where(function(t){return t[2]>=e.point[0]-m&&t[2]<=e.point[0]+m&&t[3]<=c&&t[3]>=h}).toArray();var d=Enumerable.from(e.all).where(function(t){return(a===-1||isMetal(e.pLesser)||a===Mod(t[0],t[1]))&&e.point[0]-t[2]>=l&&e.point[0]-t[2]<=s&&e.point[1]-t[3]>=i&&e.point[1]-t[3]<=o});t(-n,n,-n,n);var v=d.toArray();if("none"===e.pointType)return e.ar=AssignResult.error,e.result=[],e;if(n>.2)return e.resultString="Input uncertainty too large. Please give more significant figures.",e.ar=AssignResult.error,e.result=[],e;if("red"===e.pointType){if(null!=e.bluePoint?e.bluePoint[0]-e.point[0]<.02?t(-.008,.008,-.015,.015):t(-.03,-.005,-.015,.015):t(-.02,.008,-.015,.015),1===d.count()&&v.length<=1)return e.ar=AssignResult.accurate,e.resultString+='The assignment result is:<br /><span style="font-size: 28px;">',r(),e;t(-.04,.0126,-.03,.03)}else t(-.07,.07,-.04,.04);if(d.union(v),d.count()>0)return e.ar=AssignResult.possible,e.resultString+='The likely assignments include:<br /><span style="font-size: 28px;">',r(),e;t(-.07,.07,-.04,.04);var f=Enumerable.from(e.all).orderBy(u).toArray();return u(f[0])/u(f[1])<=.5&&0!==d.count()?(e.ar=AssignResult.impossible,d=Enumerable.from([f[0]]),e.resultString+='No match. The most possible assignment result is:<br /><span style="font-size: 28px;">',r(),e):(e.ar=AssignResult.error,e.resultString="Invalid input: out of range. Please check your input.",e.result=[],e)}function processOutput(e){for(var t=isMetal(e.pLesser)?.51:e.point[1]+.4,r=e.point[0]-.5,a=e.point[0]+.5,n=getRBMArray(e.pLesser,e.type),l=[],s=[],i=[],o=function(e,t,r){return e>=t&&e<=r||e>=r&&e<=t},p=0;p<n.rbm.length;p++){var u=n.rbm[p],m=void 0;if(2===u.length)m=(u[0][0]-u[1][0])*(t-u[1][1])/(u[0][1]-u[1][1])+u[1][0];else{var c=void 0;c=o(t,u[1][1],u[0][1])?0:2,m=(u[c][0]-u[1][0])*(t-u[1][1])/(u[c][1]-u[1][1])+u[1][0]}o(m,a,r)&&(l.push(n.rbm[p]),s.push(n.rbmLabel[p]),i.push(m))}e.rbm=l,e.rbmLabel=s,e.rbmPos=i;var h=e.all,d=Enumerable.from(h).groupBy(function(e){return 2*e[0]+e[1]},function(e){return e},function(e,t){return{key:e,value:t.orderBy(function(e){return e[0]}).toArray()}});e.all=d.select(function(e){return e.value.map(function(e){return[e[2],e[3]]})}).toArray(),e.allLabel=d.select(function(e){return e.value.map(function(e){return[e[0],e[1]]})}).toArray();var v=e.result;return e.result=v.map(function(e){return[e[2],e[3]]}),e.resultLabel=v.map(function(e){return[e[0],e[1]]}),e.isMetal=isMetal(e.pLesser),e.yAxisLabel="\\("+p1Name_raw[e.p1Lesser+1]+"-"+p1Name_raw[e.p1Lesser]+"\\ (\\mathrm{eV})\\)",e.xAxisLabel="\\(("+p1Name_raw[e.p1Lesser+1]+"+"+p1Name_raw[e.p1Lesser]+")/2\\ (\\mathrm{eV})\\)",e}function drawPlot(e,t){for(var r=4,a=t.point[0]-.5,n=t.point[0]+.5,l=t.isMetal?-.01:t.point[1]-.4,s=t.isMetal?.45:t.point[1]+.4,i={size:20,lineHeight:20,family:"serif"},o={xaxis:{show:!0,position:"bottom",min:a,max:n,font:i,tickLength:10,tickColor:"rgb(255, 0, 0)",color:"rgb(255, 0, 0)"},yaxis:{show:!0,min:l,max:s,font:i,tickLength:10,tickColor:"rgb(0, 0, 0)",color:"rgb(0, 0, 0)"},series:{hoverable:!0},grid:{borderColor:{top:"rgb(0, 0, 255)",bottom:"rgb(255, 0, 0)",left:"rgb(0, 0, 0)",right:"rgb(0, 0, 0)"},hoverable:!0,minBorderMargin:0}},p=[],u=0;u<t.rbm.length;u++)p.push({color:"rgb(208, 208, 208)",data:t.rbm[u],shadowSize:5,hoverable:!1});for(var m=[1240/785,1240/633,1240/532],c=["rgb(136, 136, 136)","rgb(245, 0, 0)","rgb(12, 127, 15)"],h=0;h<m.length;h++)p=p.concat([{id:"laser"+h.toString(),color:c[h],data:[[-10,2*(-10-m[h])],[10,2*(10-m[h])]],shadowSize:0},{id:"laser_minus"+h.toString(),color:c[h],data:[[-10,-2*(-10-m[h])],[10,-2*(10-m[h])]],shadowSize:0},{fillBetween:"laser"+h.toString(),color:c[h],data:[[-10,2*(-10-(m[h]-.1))],[10,2*(10-(m[h]-.1))]],lines:{fill:.3,lineWidth:0}},{fillBetween:"laser_minus"+h.toString(),color:c[h],data:[[-10,-2*(-10-(m[h]-.1))],[10,-2*(10-(m[h]-.1))]],lines:{fill:.3,lineWidth:0}},{fillBetween:"laser"+h.toString(),color:c[h],data:[[-10,2*(-10-(m[h]+.1))],[10,2*(10-(m[h]+.1))]],lines:{fill:.3,lineWidth:0}},{fillBetween:"laser_minus"+h.toString(),color:c[h],data:[[-10,-2*(-10-(m[h]+.1))],[10,-2*(10-(m[h]+.1))]],lines:{fill:.3,lineWidth:0}}]);for(var d=0;d<t.all.length;d++){var v=(2*t.allLabel[d][0][0]+t.allLabel[d][0][1])%3;p.push({color:t.isMetal||2===v?"rgb(0, 0, 0)":"rgb(255, 0, 0)",data:t.all[d],points:{show:!0,radius:t.isMetal?5.85:r,symbol:t.isMetal?"circle":2===v?"square":"triangle"},lines:{show:!0},point_labels:t.allLabel[d],hoverable:!0})}for(var f=0;f<t.result.length;f++){var g=(2*t.resultLabel[f][0]+t.resultLabel[f][1])%3;p.push({color:t.isMetal||2===g?"rgb(0, 0, 0)":"rgb(255, 0, 0)",data:[t.result[f]],points:{show:!0,radius:t.isMetal?5.85:r,symbol:t.isMetal?"circle":2===g?"square":"triangle",fill:!0,fillColor:t.isMetal||2===g?"rgb(0, 0, 0)":"rgb(255, 0, 0)"},point_labels:[t.resultLabel[f]],hoverable:!0})}"none"!==t.pointType&&p.push({color:"green"===t.pointType?"rgb(12, 180, 15)":"rgb(255, 0, 0)",data:[t.point],points:{show:!0,symbol:"green"===t.pointType?"diamond":"square",radius:r,fill:!0,fillColor:"green"===t.pointType?"rgba(0, 0, 0, 0)":"rgb(255, 0, 0)"},hoverable:!1}),null!==t.bluePoint&&p.push({color:"rgb(0, 0, 255)",data:[t.bluePoint],points:{show:!0,symbol:"diamond",radius:r,fill:!0,fillColor:"rgba(0, 0, 0, 0)"},hoverable:!1,shadowSize:0});var b=$("#"+e),y=$.plot(b,p,o),P=null;if(b.bind("plothover",function(e,t,r){r?P!==r.dataIndex&&(P=r.dataIndex,$("#tooltip").remove(),showTooltip(r.pageX,r.pageY,"("+r.series.point_labels[r.dataIndex][0]+", "+r.series.point_labels[r.dataIndex][1]+")")):($("#tooltip").remove(),P=null)}),t.isMetal)for(var w=0;w<t.all.length;w++){var M=Math.floor(t.all.length/2),_=t.all[w][t.all[w].length-1],N=t.allLabel[w][t.all[w].length-1],T=y.pointOffset({x:_[0],y:_[1]}),S=y.getAxes(),x=S.xaxis,E=S.yaxis;w%2===M%2&&_[0]<=x.max&&_[0]>=x.min&&_[1]<=E.max-.05&&_[1]>=E.min+.05&&b.append('\n                    <div class="series_label" style="left: '+(T.left-(w===M?60:10))+"px; top: "+(T.top-30)+'px;">\n                        <p>'+(w===M?"2<i>n</i>+<i>m</i>=":"")+(2*N[0]+N[1])+"</p>\n                    </div>\n                ")}else for(var L=Math.round(t.all.length/2),B=t.allLabel[L][t.all[L].length-1],A=Math.floor((2*B[0]+B[1])/3),C=0;C<t.all.length;C++){var F=t.all[C][t.all[C].length-1],R=t.allLabel[C][t.all[C].length-1],k=y.pointOffset({x:F[0],y:F[1]}),D=y.getAxes(),I=D.xaxis,V=D.yaxis,U=Math.round((2*R[0]+R[1])/3),z=(2*R[0]+R[1])%3;if(A%2===U%2&&F[0]<=I.max-.02&&F[0]>=I.min+.02&&F[1]<=V.max-.1&&F[1]>=V.min+.1){var O={color:1===z?"#FF0000":"#000000",left:k.left-(A===U?60:10),top:k.top-(1===z?-15:A===U&&F[1]<=V.max-.15&&F[1]>=V.min+.18?60:30),c1:A!==U?"":(2===z&&F[1]<=V.max-.15?"<b>MOD2</b><br/>":"")+"2<i>n</i>+<i>m</i>=",c2:2*R[0]+R[1],c3:A===U&&1===z&&F[1]>=V.min+.12?"<br/><b>MOD1</b>":""};b.append('\n                        <div class="series_label" style="color:'+O.color+";left:"+O.left+"px;top:"+(O.top-0)+'px;">\n                            <p>'+O.c1+O.c2+O.c3+"</p>\n                        </div>\n                    ")}}for(var W=0;W<t.rbm.length;W++)if(W%2===0||1===t.rbm.length){var q=y.pointOffset({x:t.rbmPos[W],y:s});b.append('\n                <div class="rbm_label" style="left:'+(q.left-15)+"px;top:"+(q.top-30)+'px;">\n                    <p>'+t.rbmLabel[W]+"</p>\n                </div>\n            ")}}function showTooltip(e,t,r){$('\n        <div id="tooltip" class="tooltip right in">\n            <div class="tooltip-arrow" style="top: 50%;"></div>\n            <div class="tooltip-inner">'+r+"</div>\n        </div>\n    ").css({display:"block",top:t,left:e}).appendTo("body").fadeIn(200)}function clearTitle(){$(".bootstrap-select").find("button").removeAttr("title")}function validate(e){var t=$("#hint"),r=function(e){return t.addClass("alert-danger").html('<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span> '+e),!1},a=parseFloat(e.Val1.value),n=parseFloat(e.Val2.value),l=parseInt(e.RBM.value),s=Number(isNaN(a))+Number(isNaN(n))+Number(isNaN(l));return s>=2?r("At least 2 values are required."):!isNaN(a)&&(a<0||a>4)||!isNaN(n)&&(n<0||n>4)||!isNaN(l)&&(l<30||l>500)?r("Please input valid value."):""===$("#slP1").selectpicker("val")?r("Please select the type of transition energy."):($(".selectpicker").removeAttr("disabled"),history.replaceState(null,null,"Step2.html?"+["Type","P1","Val1","P2","Val2","RBM"].map(function(t){return t+"="+e[t].value}).join("&")),!0)}function changeEdit(e,t,r){$("#slP1").selectpicker("val",e),$("#slP2").selectpicker("val",e+1),$("#edVal1").val(t),$("#edVal2").val(r)}function calculate(e){var t=$("#calculatorHint"),r=$("#calcResult"),a=function(){t.html('\n      <div class="alert-danger hint">\n        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>\n        No valid result.\n      </div>\n    '),r.html("")},n=parseInt(e.NCalc.value),l=parseInt(e.MCalc.value),s=parseInt(urlParams.Type);if(n<l){var i=[l,n];n=i[0],l=i[1]}if(isNaN(n)||isNaN(l)||n<=6||l<=0||2*n+l>seriesThreshold)return a(),!1;t.html("");var o=$("<tbody></tbody>"),p=$("<div></div>");r.html("").append($('<table class="table table-striped math" id="calcResultList"></table>').append(o)).append(p),o.append("<tr><td>\\(d_t\\)</td><td>\\( "+Dt(n,l,s).toFixed(3).toString()+" \\ \\mathrm{nm}\\)</td></tr>"),generateRBMCalculationResult(n,l,s,o);for(var u=new Array(12),m=0;m<12;m++)if(isMetal(p1ToP(m))===isMetal(n,l))try{u[m]=getEnergy(Dt(n,l,s),Theta(n,l),p1ToP(m),s,isMetal(n,l)?m%2-1:Mod(n,l)).toFixed(3).toString()}catch(c){u[m]=-1}else u[m]=-1;for(var h=0,d=function(e){if(u[e]===-1||u[e+1]===-1)return"continue";h++,o.append($("<tr><td>"+p1Name[e]+"</td><td>\\("+u[e]+"\\ \\mathrm{eV}\\)</td></tr>").click(function(){return changeEdit(e,u[e],u[e+1])}).css("cursor","pointer")).append($("<tr><td>"+p1Name[e+1]+"</td><td>\\("+u[e+1]+"\\ \\mathrm{eV}\\)</td></tr>").click(function(){return changeEdit(e,u[e],u[e+1])}).css("cursor","pointer"));var t={type:s,p1:e,p2:e+1,val1:u[e],val2:u[e+1],rbm:""},r=processOutput(getPlotParams(t)),a="calcPlot"+Math.round(e/2),n=$('\n      <div class="math calc-plot-container" \n           oncontextmenu="return false" onmousedown="return false">\n        <div class="row">\n          <div class="col-lg-offset-2 col-md-offset-6 rbmAxisLabel">\n            \\(\\omega_{\\mathrm{RBM}}\\ (\\mathrm{cm^{-1}})\\)\n          </div>\n        </div>\n        <br />\n        <div class="row" style="position: relative;">\n          <div class="yAxisLabel">'+r.yAxisLabel+'</div>\n          <div id="'+a+'" style="width: 400px; height: 290px; font-family: \'Times New Roman\', serif;"\n               class="col-md-offset-1 col-xs-offset-1"></div>\n        </div>\n        <div class="row">\n          <div class="col-lg-offset-2 col-md-offset-5 xAxisLabel">\n               '+r.xAxisLabel+"\n          </div>\n        </div>\n      </div>\n    ");p.append(n),drawPlot(a,r)},v=0;v<12;v+=2){d(v)}return 0===h&&a(),MathJax.Hub.Queue(["Typeset",MathJax.Hub]),!1}function generateRBMCalculationResult(e,t,r,a){var n=0===r,l=function(e){return $("#edRBM").val(e)};if(n){var s=dt2RBM(Dt(e,t,r),isMetal(e,t)?2:0,r).toFixed(1).toString();a.append($("\n        <tr>\n            <td>\\(\\omega_\\mathrm{RBM}\\ "+(isMetal(e,t)?"(p=3)":"(p=1,2)")+" \\)</td>\n            <td>\\( "+s+" \\ \\mathrm{cm^{-1}}\\)</td>\n        </tr>\n      ").click(function(){return l(s)}).css("cursor","pointer"))}var i=dt2RBM(Dt(e,t,r),n?3:0,r).toFixed(1).toString();a.append($("\n      <tr>\n          <td>\\(\\omega_\\mathrm{RBM}\\ "+(n?"(p>3)":"")+" \\)</td>\n          <td>\\( "+i+" \\ \\mathrm{cm^{-1}}\\)</td>\n      </tr>\n    ").click(function(){return l(i)}).css("cursor","pointer"))}var seriesThreshold=90,AssignResult={accurate:0,possible:1,impossible:2,error:3},typeName=["Air-suspended SWNTs","SWNTs on \\(\\mathrm{SiO_2}/\\mathrm{Si}\\) substrates","SWNT arrays on quartz substrates",'"Super-growth" SWNTs',"SDS-dispersed SWNTs","ssDNA-dispersed SWNTs"],type0Params=[[1.194,.179,.053],[2.11,.388,.154],[3.17,.764,.286],[4.286,1.23,.412],[5.38,1.922,.644],[6.508,2.768,.928],[7.624,3.768,1.024],[8.734,4.921,1.479],[9.857,6.228,1.692]],type3Params=[[.09,-.07],[-.18,.14],[-.19,.29],[.49,-.33],[-.43,.59],[-.6,.57]],p1Name=["\\(S_{11}\\)","\\(S_{22}\\)","\\(M_{11}^-\\)","\\(M_{11}^+\\)","\\(S_{33}\\)","\\(S_{44}\\)","\\(M_{22}^-\\)","\\(M_{22}^+\\)","\\(S_{55}\\)","\\(S_{66}\\)","\\(M_{33}^-\\)","\\(M_{33}^+\\)"],p1Name_raw=["S_{11}","S_{22}","M_{11}^-","M_{11}^+","S_{33}","S_{44}","M_{22}^-","M_{22}^+","S_{55}","S_{66}","M_{33}^-","M_{33}^+"],p1ToP=function(e){return[0,1,2,2,3,4,5,5,6,7,8,8][e]},pToLesser=function(e){return[0,0,2,3,3,5,6,6,9][e]},p1ToLesser=function(e){return e%2===0?e:e-1},Dt=function(e,t,r){return(4!==r?.142:.144)*Math.sqrt(3*(e*e+e*t+t*t))/Math.PI},Theta=function(e,t){return Math.atan(Math.sqrt(3)*t/(2*e+t))},Mod=function(e,t){return(2*e+t)%3},isMetal=function(){var e=function(e){return(e+1)%3===0},t=function(e,t){return 0===Mod(e,t)};return 2===arguments.length?t(arguments[0],arguments[1]):e(arguments[0])},getEnergy=function(e,t,r,a,n){return getEnergyFromCos3Theta(e,Math.cos(3*t),r,a,n)},isUnparsable=function(e){return isNaN(parseFloat(e))},timeLoad=performance.now(),timeStartup=void 0;$.getScript("zh"!==navigator.language.substr(0,2).toLowerCase()?"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js":"https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS_SVG-full,Safe&locale=en",function(){timeStartup=performance.now(),console.log("MathJax load takes "+(timeStartup-timeLoad).toFixed(2))});var urlParams={};(window.onpopstate=function(){var e=void 0,t=/\+/g,r=/([^&=]+)=?([^&]*)/g,a=function(e){return decodeURIComponent(e.replace(t," "))},n=window.location.search.substring(1);for(urlParams={};e=r.exec(n);)urlParams[a(e[1])]=a(e[2])})(),/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)&&$(".selectpicker").selectpicker("mobile");var $body=$("body");if($body.hasClass("Step1")){for(var $selectType=$("#slType"),i=0;i<typeName.length;i++)$selectType.append('<option value="'+i+'">'+typeName[i]+"</option>");$selectType.selectpicker("val",0).selectpicker("refresh").on("loaded.bs.select",clearTitle).on("changed.bs.select",clearTitle)}if($body.hasClass("Step2")){var type=parseInt(urlParams.Type);(isNaN(type)||type>5||type<0)&&(location.href="Step1.html");var $selectP1=$("#slP1"),$selectP2=$("#slP2"),_$selectType=$("#slType"),$selectP1P2=$("#slP1, #slP2");$("#title")[0].innerHTML+=" <small>"+typeName[type]+"</small>",$("#dataTables").find(".type"+type).removeClass("hidden");for(var _i=0;_i<p1Name.length;_i++){if(type>=3){var threshold=3===type?8:2;if(_i>=threshold)break}$selectP1P2.append('<option value="'+_i+'">'+p1Name[_i]+"</option>")}for(var _i2=0;_i2<typeName.length;_i2++)_$selectType.append('<option value="'+_i2+'">'+typeName[_i2]+"</option>");if(["P1","P2","Val1","Val2","RBM"].every(function(e){return void 0!==urlParams[e]})){var params={p1:parseInt(urlParams.P1),p2:parseInt(urlParams.P2),val1:urlParams.Val1,val2:urlParams.Val2,rbm:urlParams.RBM},valueBetween=function(e,t,r){return e>=t&&e<=r},val1_=parseFloat(params.val1),val2_=parseFloat(params.val2),rbm_=parseFloat(params.rbm),emptyNum=Number(isNaN(val1_))+Number(isNaN(val2_))+Number(isNaN(rbm_));(emptyNum>=2||isNaN(params.p1)||isNaN(params.p2)||!isNaN(val1_)&&!valueBetween(val1_,0,4)||!isNaN(val2_)&&!valueBetween(val2_,0,4)||!isNaN(rbm_)&&!valueBetween(rbm_,30,500)||!valueBetween(params.p1,0,11)||!valueBetween(params.p2,0,11))&&(location.href="Step1.html"),$selectP1.selectpicker("val",params.p1),$selectP2.selectpicker("val",params.p2),$("#edVal1").val(params.val1),$("#edVal2").val(params.val2),$("#edRBM").val(params.rbm)}else["P1","P2","Val1","Val2","RBM"].every(function(e){return void 0!==urlParams[e]})&&(location.href="Step1.html");_$selectType.selectpicker("val",type),$(".selectpicker").selectpicker("refresh"),$("select").on("loaded.bs.select",clearTitle),$selectP1.on("changed.bs.select",function(e,t){var r=t-1;clearTitle(),$selectP2.find("option").each(function(){var e=parseInt($(this).val());(r%2===0&&e===r+1||r%2===1&&e===r-1)&&$selectP2.selectpicker("val",e)})})}if($body.hasClass("Step3")){["Type","P1","P2","Val1","Val2","RBM"].every(function(e){return void 0!==urlParams[e]})||(location.href="Step1.html");var inputParams={type:parseInt(urlParams.Type),p1:parseInt(urlParams.P1),p2:parseInt(urlParams.P2),val1:urlParams.Val1,val2:urlParams.Val2,rbm:urlParams.RBM},_valueBetween=function(e,t,r){return e>=t&&e<=r},_val1_=parseFloat(inputParams.val1),_val2_=parseFloat(inputParams.val2),_rbm_=parseFloat(inputParams.rbm),_emptyNum=Number(isNaN(_val1_))+Number(isNaN(_val2_))+Number(isNaN(_rbm_));!(_emptyNum>=2||isNaN(inputParams.type)||isNaN(inputParams.p1)||isNaN(inputParams.p2)||!isNaN(_val1_)&&!_valueBetween(_val1_,0,4)||!isNaN(_val2_)&&!_valueBetween(_val2_,0,4)||!isNaN(_rbm_)&&!_valueBetween(_rbm_,30,500))&&_valueBetween(inputParams.type,0,5)&&_valueBetween(inputParams.p1,0,11)&&_valueBetween(inputParams.p2,0,11)||(location.href="Step1.html"),$("#title")[0].innerHTML+=" <small>"+typeName[inputParams.type]+"</small>";var plotParams=processOutput(getPlotParams(inputParams));$("#resultDiv").addClass(plotParams.ar!==AssignResult.error?"alert-success":"alert-danger").html(plotParams.resultString),$("#yAxisLabel").html(plotParams.yAxisLabel),$("#xAxisLabel").html(plotParams.xAxisLabel),$("#"+plotParams.pointType+"Legend").css("display",""),null!==plotParams.bluePoint&&$("#blueLegend").css("display",""),$(drawPlot("plot-placeholder",plotParams))}
//# sourceMappingURL=app.min.js.map
