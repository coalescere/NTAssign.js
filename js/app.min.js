"use strict";function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var seriesThreshold=90,AssignResult={accurate:0,possible:1,impossible:2,error:3},typeName=["Air-suspended SWNTs","SWNTs on \\(\\mathrm{SiO_2}/\\mathrm{Si}\\) substrates","SWNT arrays on quartz substrates",'"Super-growth" SWNTs',"SDS-dispersed SWNTs","ssDNA-dispersed SWNTs"],type0Params=[[1.194,.179,.053],[2.11,.388,.154],[3.17,.764,.286],[4.286,1.23,.412],[5.38,1.922,.644],[6.508,2.768,.928],[7.624,3.768,1.024],[8.734,4.921,1.479],[9.857,6.228,1.692]],type3Params=[[.09,-.07],[-.18,.14],[-.19,.29],[.49,-.33],[-.43,.59],[-.6,.57]],p1Name=["\\(S_{11}\\)","\\(S_{22}\\)","\\(M_{11}^-\\)","\\(M_{11}^+\\)","\\(S_{33}\\)","\\(S_{44}\\)","\\(M_{22}^-\\)","\\(M_{22}^+\\)","\\(S_{55}\\)","\\(S_{66}\\)","\\(M_{33}^-\\)","\\(M_{33}^+\\)"],p1Name_raw=["S_{11}","S_{22}","M_{11}^-","M_{11}^+","S_{33}","S_{44}","M_{22}^-","M_{22}^+","S_{55}","S_{66}","M_{33}^-","M_{33}^+"],p1ToP=function(e){return[0,1,2,2,3,4,5,5,6,7,8,8][e]},pToLesser=function(e){return[0,0,2,3,3,5,6,6,9][e]},p1ToLesser=function(e){return e%2==0?e:e-1},Dt=function(e,a,r){return(4!==r?.142:.144)*Math.sqrt(3*(e*e+e*a+a*a))/Math.PI},Theta=function(e,a){return Math.atan(Math.sqrt(3)*a/(2*e+a))},Mod=function(e,a){return(2*e+a)%3},isMetal=function(){var e,a;return 2===arguments.length?(e=arguments[0],a=arguments[1],0===Mod(e,a)):(arguments[0]+1)%3==0};function getRBMParameters(e,a){var r=function e(a,r){_classCallCheck(this,e),this.a=a,this.b=r};switch(a){case 0:switch(e){case 0:case 1:return new r(204,27);case 2:return new r(200,26);default:return new r(228,0)}case 1:return new r(235.9,5.5);case 2:return new r(217.8,15.7);case 3:return new r(227,.3);case 4:return new r(223.5,12.5);case 5:return new r(218,18.3);default:throw new Error("invalid type")}}function wRBM2Dt(e,a,r){var t=getRBMParameters(a,r);return t.a/(e-t.b)}function dt2RBM(e,a,r){var t=getRBMParameters(a,r);return t.a/e+t.b}var getEnergy=function(e,a,r,t,l){return getEnergyFromCos3Theta(e,Math.cos(3*a),r,t,l)};function getEnergyFromCos3Theta(a,r,t,e,l){var n=void 0;if(isMetal(t)&&0<l)throw new Error("mod should be in accordance with p");if(e<=2){if(9<=t)throw new Error("higher than S66 not available");if(0<-type0Params[t][0]/(a*a)+2*type0Params[t][1]/(a*a*a))throw new Error("dt");n=isMetal(t)?type0Params[t][0]/a-type0Params[t][1]/(a*a)+type0Params[t][2]/(a*a)*r*(2*l+1):type0Params[t][0]/a-type0Params[t][1]/(a*a)+type0Params[t][2]/(a*a)*r*(t%3==l%2?-1:1),n-=1===e?.04:2===e?.1:0}else if(3===e){if(6<=t)throw new Error("higher than M22 not available for Super-Growth");var s=function(e){return 1.074*(t+1)/a*(1+.467*Math.log10(.812/((t+1)/a)))+type3Params[t][e]/(a*a)*r+(2<t?.059*(t+1)/a:0)};n=isMetal(t)?s(l+1):s(l-1)}else{if(4!==e&&5!==e)throw new Error("invalid type");if(0===t)n=1/(.127+.8606*a)+(1===l?.04575:-.08802)/(a*a)*r;else{if(1!==t)throw new Error("only S11 and S22 are available for SDS-dispersed or ssDNA dispersed");n=1/(.1174+.4644*a)+(1===l?-.1829:.1705)/(a*a)*r}n-=5===e?.02:0}return n}function getCos3Theta(a,r,t,e){var l=[-1,-1];if(e<=2){if(9<=t)throw new Error("higher than S66 not available");a+=1===e?.04:2===e?.1:0,isMetal(t)?(l[0]=(type0Params[t][0]/r-type0Params[t][1]/(r*r)-a)/type0Params[t][2]*(r*r),l[1]=-(type0Params[t][0]/r-type0Params[t][1]/(r*r)-a)/type0Params[t][2]*(r*r)):(l[0]=-(type0Params[t][0]/r-type0Params[t][1]/(r*r)-a)/type0Params[t][2]*(r*r)*(t%3==1?-1:1),l[1]=-(type0Params[t][0]/r-type0Params[t][1]/(r*r)-a)/type0Params[t][2]*(r*r)*(t%3==0?-1:1))}else if(3===e){if(6<=t)throw new Error("higher than M22 not available for Super-Growth");var n=function(e){return(a-1.074*(t+1)/r*(1+.467*Math.log10(.812/((t+1)/r)))-(2<t?.059*(t+1)/r:0))/type3Params[t][e]*(r*r)};l[0]=n(0),l[1]=n(1)}else{if(4!==e&&5!==e)throw new Error("invalid type");if(a+=5===e?.02:0,0===t)l[0]=(a-1/(.127+.8606*r))/.04575*(r*r),l[1]=(a-1/(.127+.8606*r))/-.08802*(r*r);else{if(1!==t)throw new Error("only S11 and S22 are available for SDS-disp. or ssDNA disp.");l[0]=(a-1/(.1174+.4644*r))/-.1829*(r*r),l[1]=(a-1/(.1174+.4644*r))/.1705*(r*r)}}return l[0]=parseFloat(l[0].toFixed(4)),l[1]=parseFloat(l[1].toFixed(4)),(1<l[0]||l[0]<0)&&(l[0]=-1),(1<l[1]||l[1]<0)&&(l[1]=-1),l}function getAverage(e,a,r,t){var l=wRBM2Dt(a,r,t);if(isMetal(r+1))throw new Error("p should be the smaller one");if(!(t<=2)){if(3===t){var n=function(e){return 1.074*(e+1)/l*(1+.467*Math.log10(.812/((e+1)/l)))+(2<e?.059*(e+1)/l:0)};if(isMetal(r)){var s=e*l*l/(type3Params[r][1]-type3Params[r][0]);return s<0||1.5<s?null:(getEnergyFromCos3Theta(l,s,r,t,-1)+getEnergyFromCos3Theta(l,s,r,t,0))/2}var i=r+1,o=1;if(6<=r)throw new Error("higher than M22 not available for Super-Growth");var p=(e+n(r)-n(i))*l*l/(type3Params[i][o-1]-type3Params[r][o-1]);return(p<0||1.5<p)&&(o=2,p=(e+n(r)-n(i))*l*l/(type3Params[i][o-1]-type3Params[r][o-1])),p<0||1.5<p?null:(getEnergyFromCos3Theta(l,p,i,t,o)+getEnergyFromCos3Theta(l,p,r,t,o))/2}if(4===t||5===t){if(0!==r)throw new Error("only S11 and S22 are available for SDS-disp. or ssDNA disp.");var u=1,m=(e-(1/(.1174+.4644*l)-1/(.127+.8606*l)))*l*l/(-.1829-.04575);return(1.5<m||m<0)&&(u=2,m=(e-(1/(.1174+.4644*l)-1/(.127+.8606*l)))*l*l/.25852),1.5<m||m<0?null:(getEnergyFromCos3Theta(l,m,1,t,u)+getEnergyFromCos3Theta(l,m,0,t,u))/2}throw new Error("invalid type")}if(9<=r)throw new Error("higher than S66 not available");if(isMetal(r)){var c=l*l*e/2*type0Params[r][2];if(c<0||1.5<c)return null;try{return(getEnergyFromCos3Theta(l,c,r,t,-1)+getEnergyFromCos3Theta(l,c,r,t,0))/2}catch(e){if("dt"===e.message)return null;throw e}}else{var h=r+1,d=function(e){return type0Params[h][e]-type0Params[r][e]},v=1,f=(e*l*l-d(0)*l+d(1))/(type0Params[h][2]*(h%3==v%2?-1:1)-type0Params[r][2]*(r%3==v%2?-1:1));if(f<0&&(v=2,f=-f),1.5<f)return null;try{return(getEnergyFromCos3Theta(l,f,h,t,v)+getEnergyFromCos3Theta(l,f,r,t,v))/2}catch(e){if("dt"===e.message)return null;throw e}}}function getList(e,a){var r=[];if(isMetal(e))for(var t=5;t<50;t++)for(var l=0;l<=t&&!(seriesThreshold<2*t+l);l++)try{if(isMetal(t,l)){var n=getEnergy(Dt(t,l,a),Theta(t,l),e,a,-1),s=getEnergy(Dt(t,l,a),Theta(t,l),e,a,0);r.push([t,l,(s+n)/2,s-n])}}catch(e){if("dt"!==e.message)throw e}else{if(isMetal(e+1))throw new Error("p should be the smaller one, e.g. S11 rather than S22");for(var i=5;i<50;i++)for(var o=0;o<=i&&!(seriesThreshold<2*i+o);o++)try{if(!isMetal(i,o)){var p=getEnergy(Dt(i,o,a),Theta(i,o),e,a,Mod(i,o)),u=getEnergy(Dt(i,o,a),Theta(i,o),e+1,a,Mod(i,o));r.push([i,o,(u+p)/2,u-p])}}catch(e){if("dt"!==e.message)throw e}}return r}function getRBMArray(e,a){var r={rbmLabel:[],rbm:[]};if(!isMetal(e)&&isMetal(e+1))throw new Error("p should be the smaller one, e.g. S11 rather than S22");for(var t=70;t<=350;t+=10){var l=wRBM2Dt(t,e,a),n=[];try{if(isMetal(e)){var s=getEnergyFromCos3Theta(l,60,e,a,0),i=getEnergyFromCos3Theta(l,60,e,a,-1);n.push([(s+i)/2,s-i]),s=getEnergyFromCos3Theta(l,-60,e,a,0),i=getEnergyFromCos3Theta(l,-60,e,a,-1),n.push([(s+i)/2,s-i]),r.rbmLabel.push(t),r.rbm.push(n)}else{var o=getEnergyFromCos3Theta(l,60,e+1,a,1),p=getEnergyFromCos3Theta(l,60,e,a,1);n.push([(o+p)/2,o-p]),o=getEnergyFromCos3Theta(l,0,e+1,a,2),p=getEnergyFromCos3Theta(l,0,e,a,2),n.push([(o+p)/2,o-p]),o=getEnergyFromCos3Theta(l,60,e+1,a,2),p=getEnergyFromCos3Theta(l,60,e,a,2),n.push([(o+p)/2,o-p]),r.rbmLabel.push(t),r.rbm.push(n)}}catch(e){if("dt"===e.message)break;throw e}}return r}var isUnparsable=function(e){return isNaN(parseFloat(e))};function getPlotParams(e){var a=function(e){return e.split(".")[1].length};if(isUnparsable(e.val1)&&isUnparsable(e.val2))throw new Error("Unauthorized Access");if(isUnparsable(e.val1)||isUnparsable(e.val2)){if(isUnparsable(e.rbm))throw new Error("Unauthorized Access");return e.uncertainty=2/Math.pow(10,a(isUnparsable(e.val1)?e.val2:e.val1)),E1R1(e)}return e.uncertainty=2/Math.pow(10,Math.min(a(e.val1),a(e.val2))),E2(e)}function E1R1(e){var a=isUnparsable(e.val1)?e.p2:e.p1,r=e.type,t=p1ToP(a),l=parseFloat(isUnparsable(e.val1)?e.val2:e.val1),n=wRBM2Dt(parseFloat(e.rbm),t,r),s=getCos3Theta(l,n,t,r),i="",o=function(){return Assign({bluePoint:null,point:[l,.23],pLesser:pToLesser(t),type:r,pointType:"none",p1Lesser:p1ToLesser(a),resultString:i,uncertainty:2e-4})};if(-1===s[0]&&-1===s[1])return i+="Invalid input: out of range.",o();var p=void 0,u=void 0;if(isMetal(t)){if(a%4-3!=(-1===s[0]?0:-1))return i+="Invalid input: You may have mistaken "+p1Name[a+5-a%4*2]+" for "+p1Name[a]+".",o();p=t,u=-1===s[0]?-1:0}else p=isMetal(t+1)?t-1:t+1,u=-1===s[0]?2:1;var m=void 0;try{m=getEnergyFromCos3Theta(n,-1===s[0]?s[1]:s[0],p,r,u)}catch(e){if("dt"===e.message)return i+="Invalid input: out of range, diameter too small.",o();throw e}if(isMetal(t)&&-1===u||!isMetal(t)&&p<t){var c=[p,t];t=c[0],p=c[1];var h=[m,l];l=h[0],m=h[1]}return Assign({bluePoint:null,point:[(l+m)/2,m-l],pLesser:t,type:r,pointType:"green",p1Lesser:p1ToLesser(a),resultString:i,uncertainty:e.uncertainty},u)}function E2(e){var a="",r=e.p1,t=e.p2,l=e.type,n=parseFloat(e.val1),s=parseFloat(e.val2),i=p1ToP(r),o=p1ToP(t),p=e.rbm;if(t<r){var u=[o,i];i=u[0],o=u[1];var m=[s,n];n=m[0],s=m[1];var c=[t,r];r=c[0],t=c[1]}if(isMetal(o)!==isMetal(i))throw new Error("invalid form submission");if(t-r==1){var h=null;if(!isUnparsable(p)){var d=getAverage(s-n,parseFloat(p),i,l);null!==d?h=[d,s-n]:a+="Invalid input: RBM value out of range. Only transition energies are processed. <br/ >"}return Assign({point:[(n+s)/2,s-n],pLesser:i,type:l,pointType:"red",bluePoint:h,p1Lesser:r,resultString:a,uncertainty:e.uncertainty})}}function Assign(n){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,e=n.uncertainty,l=-1,s=-1,i=-1,o=-1,r=function(e){return a=e[2],r=e[3],t=n.point[0],l=n.point[1],Math.sqrt((a-t)*(a-t)+(r-l)*(r-l)*25);var a,r,t,l},t=isMetal(n.pLesser)?.6:n.point[1]+.6,p=isMetal(n.pLesser)?-.1:n.point[1]-.6;function u(e,a,r,t){l=e,s=a,i=r,o=t}n.all=Enumerable.from(getList(n.pLesser,n.type)).where(function(e){return e[2]>=n.point[0]-.6&&e[2]<=n.point[0]+.6&&e[3]<=t&&e[3]>=p}).toArray();var m=Enumerable.from(n.all).where(function(e){return(-1===a||isMetal(n.pLesser)||a===Mod(e[0],e[1]))&&n.point[0]-e[2]>=l&&n.point[0]-e[2]<=s&&n.point[1]-e[3]>=i&&n.point[1]-e[3]<=o});u(-e,e,-e,e);var c=m.toArray();function h(){n.result=m.orderBy(r).toArray();for(var e=0;e<n.result.length;e++)n.resultString+="\n        <b>("+Math.round(n.result[e][0])+","+Math.round(n.result[e][1])+")</b>\n        "+(e!==n.result.length-1?", ":"");n.resultString+="</span>"}if("none"===n.pointType)return n.ar=AssignResult.error,n.result=[],n;if(.2<e)return n.resultString="Input uncertainty too large. Please give more significant figures.",n.ar=AssignResult.error,n.result=[],n;if("red"===n.pointType){if(null!=n.bluePoint?n.bluePoint[0]-n.point[0]<.02?u(-.008,.008,-.015,.015):u(-.03,-.005,-.015,.015):u(-.02,.008,-.015,.015),1===m.count()&&c.length<=1)return n.ar=AssignResult.accurate,n.resultString+='The assignment result is:<br /><span style="font-size: 28px;">',h(),n;u(-.04,.0126,-.03,.03)}else u(-.07,.07,-.04,.04);if(m.union(c),0<m.count())return n.ar=AssignResult.possible,n.resultString+='The likely assignments include:<br /><span style="font-size: 28px;">',h(),n;u(-.07,.07,-.04,.04);var d=Enumerable.from(n.all).orderBy(r).toArray();return r(d[0])/r(d[1])<=.5&&0!==m.count()?(n.ar=AssignResult.impossible,m=Enumerable.from([d[0]]),n.resultString+='No match. The most possible assignment result is:<br /><span style="font-size: 28px;">',h()):(n.ar=AssignResult.error,n.resultString="Invalid input: out of range. Please check your input.",n.result=[]),n}function processOutput(e){for(var a=isMetal(e.pLesser)?.51:e.point[1]+.4,r=e.point[0]-.5,t=e.point[0]+.5,l=getRBMArray(e.pLesser,e.type),n=[],s=[],i=[],o=function(e,a,r){return a<=e&&e<=r||r<=e&&e<=a},p=0;p<l.rbm.length;p++){var u=l.rbm[p],m=void 0;if(2===u.length)m=(u[0][0]-u[1][0])*(a-u[1][1])/(u[0][1]-u[1][1])+u[1][0];else{var c=void 0;m=(u[c=o(a,u[1][1],u[0][1])?0:2][0]-u[1][0])*(a-u[1][1])/(u[c][1]-u[1][1])+u[1][0]}o(m,t,r)&&(n.push(l.rbm[p]),s.push(l.rbmLabel[p]),i.push(m))}e.rbm=n,e.rbmLabel=s,e.rbmPos=i;var h=e.all,d=Enumerable.from(h).groupBy(function(e){return 2*e[0]+e[1]},function(e){return e},function(e,a){return{key:e,value:a.orderBy(function(e){return e[0]}).toArray()}});e.all=d.select(function(e){return e.value.map(function(e){return[e[2],e[3]]})}).toArray(),e.allLabel=d.select(function(e){return e.value.map(function(e){return[e[0],e[1]]})}).toArray();var v=e.result;return e.result=v.map(function(e){return[e[2],e[3]]}),e.resultLabel=v.map(function(e){return[e[0],e[1]]}),e.isMetal=isMetal(e.pLesser),e.yAxisLabel="\\("+p1Name_raw[e.p1Lesser+1]+"-"+p1Name_raw[e.p1Lesser]+"\\ (\\mathrm{eV})\\)",e.xAxisLabel="\\(("+p1Name_raw[e.p1Lesser+1]+"+"+p1Name_raw[e.p1Lesser]+")/2\\ (\\mathrm{eV})\\)",e}function drawPlot(e,a){for(var r=a.point[0]-.5,t=a.point[0]+.5,l=a.isMetal?-.01:a.point[1]-.4,n=a.isMetal?.45:a.point[1]+.4,s={size:20,lineHeight:20,family:"serif"},i={xaxis:{show:!0,position:"bottom",min:r,max:t,font:s,tickLength:10,tickColor:"rgb(255, 0, 0)",color:"rgb(255, 0, 0)"},yaxis:{show:!0,min:l,max:n,font:s,tickLength:10,tickColor:"rgb(0, 0, 0)",color:"rgb(0, 0, 0)"},series:{hoverable:!0},grid:{borderColor:{top:"rgb(0, 0, 255)",bottom:"rgb(255, 0, 0)",left:"rgb(0, 0, 0)",right:"rgb(0, 0, 0)"},hoverable:!0,minBorderMargin:0}},o=[],p=0;p<a.rbm.length;p++)o.push({color:"rgb(208, 208, 208)",data:a.rbm[p],shadowSize:5,hoverable:!1});for(var u=[1240/785,1240/633,1240/532],m=["rgb(136, 136, 136)","rgb(245, 0, 0)","rgb(12, 127, 15)"],c=0;c<u.length;c++)o=o.concat([{id:"laser"+c.toString(),color:m[c],data:[[-10,2*(-10-u[c])],[10,2*(10-u[c])]],shadowSize:0},{id:"laser_minus"+c.toString(),color:m[c],data:[[-10,-2*(-10-u[c])],[10,-2*(10-u[c])]],shadowSize:0},{fillBetween:"laser"+c.toString(),color:m[c],data:[[-10,2*(-10-(u[c]-.1))],[10,2*(10-(u[c]-.1))]],lines:{fill:.3,lineWidth:0}},{fillBetween:"laser_minus"+c.toString(),color:m[c],data:[[-10,-2*(-10-(u[c]-.1))],[10,-2*(10-(u[c]-.1))]],lines:{fill:.3,lineWidth:0}},{fillBetween:"laser"+c.toString(),color:m[c],data:[[-10,2*(-10-(u[c]+.1))],[10,2*(10-(u[c]+.1))]],lines:{fill:.3,lineWidth:0}},{fillBetween:"laser_minus"+c.toString(),color:m[c],data:[[-10,-2*(-10-(u[c]+.1))],[10,-2*(10-(u[c]+.1))]],lines:{fill:.3,lineWidth:0}}]);for(var h=0;h<a.all.length;h++){var d=(2*a.allLabel[h][0][0]+a.allLabel[h][0][1])%3;o.push({color:a.isMetal||2===d?"rgb(0, 0, 0)":"rgb(255, 0, 0)",data:a.all[h],points:{show:!0,radius:a.isMetal?5.85:4,symbol:a.isMetal?"circle":2===d?"square":"triangle"},lines:{show:!0},point_labels:a.allLabel[h],hoverable:!0})}for(var v=0;v<a.result.length;v++){var f=(2*a.resultLabel[v][0]+a.resultLabel[v][1])%3;o.push({color:a.isMetal||2===f?"rgb(0, 0, 0)":"rgb(255, 0, 0)",data:[a.result[v]],points:{show:!0,radius:a.isMetal?5.85:4,symbol:a.isMetal?"circle":2===f?"square":"triangle",fill:!0,fillColor:a.isMetal||2===f?"rgb(0, 0, 0)":"rgb(255, 0, 0)"},point_labels:[a.resultLabel[v]],hoverable:!0})}"none"!==a.pointType&&o.push({color:"green"===a.pointType?"rgb(12, 180, 15)":"rgb(255, 0, 0)",data:[a.point],points:{show:!0,symbol:"green"===a.pointType?"diamond":"square",radius:4,fill:!0,fillColor:"green"===a.pointType?"rgba(0, 0, 0, 0)":"rgb(255, 0, 0)"},hoverable:!1}),null!==a.bluePoint&&o.push({color:"rgb(0, 0, 255)",data:[a.bluePoint],points:{show:!0,symbol:"diamond",radius:4,fill:!0,fillColor:"rgba(0, 0, 0, 0)"},hoverable:!1,shadowSize:0});var g=$("#"+e),b=$.plot(g,o,i),y=null;if(g.bind("plothover",function(e,a,r){r?y!==r.dataIndex&&(y=r.dataIndex,$("#tooltip").remove(),showTooltip(r.pageX,r.pageY,"("+r.series.point_labels[r.dataIndex][0]+", "+r.series.point_labels[r.dataIndex][1]+")")):($("#tooltip").remove(),y=null)}),a.isMetal)for(var P=0;P<a.all.length;P++){var w=Math.floor(a.all.length/2),M=a.all[P][a.all[P].length-1],_=a.allLabel[P][a.all[P].length-1],N=b.pointOffset({x:M[0],y:M[1]}),T=b.getAxes(),S=T.xaxis,x=T.yaxis;P%2==w%2&&M[0]<=S.max&&M[0]>=S.min&&M[1]<=x.max-.05&&M[1]>=x.min+.05&&g.append('\n                    <div class="series_label" style="left: '+(N.left-(P===w?60:10))+"px; top: "+(N.top-30)+'px;">\n                        <p>'+(P===w?"2<i>n</i>+<i>m</i>=":"")+(2*_[0]+_[1])+"</p>\n                    </div>\n                ")}else for(var E=Math.round(a.all.length/2),L=a.allLabel[E][a.all[E].length-1],B=Math.floor((2*L[0]+L[1])/3),A=0;A<a.all.length;A++){var C=a.all[A][a.all[A].length-1],F=a.allLabel[A][a.all[A].length-1],R=b.pointOffset({x:C[0],y:C[1]}),k=b.getAxes(),D=k.xaxis,I=k.yaxis,V=Math.round((2*F[0]+F[1])/3),U=(2*F[0]+F[1])%3;if(B%2==V%2&&C[0]<=D.max-.02&&C[0]>=D.min+.02&&C[1]<=I.max-.1&&C[1]>=I.min+.1){var z=1===U?"#FF0000":"#000000",O=R.left-(B===V?60:10),W=R.top-(1===U?-15:B===V&&C[1]<=I.max-.15&&C[1]>=I.min+.18?60:30),q=B!==V?"":(2===U&&C[1]<=I.max-.15?"<b>MOD2</b><br/>":"")+"2<i>n</i>+<i>m</i>=",j=2*F[0]+F[1],H=B===V&&1===U&&C[1]>=I.min+.12?"<br/><b>MOD1</b>":"";g.append('\n                        <div class="series_label" style="color:'+z+";left:"+O+"px;top:"+W+'px;">\n                            <p>'+q+j+H+"</p>\n                        </div>\n                    ")}}for(var J=0;J<a.rbm.length;J++)if(J%2==0||1===a.rbm.length){var G=b.pointOffset({x:a.rbmPos[J],y:n});g.append('\n                <div class="rbm_label" style="left:'+(G.left-15)+"px;top:"+(G.top-30)+'px;">\n                    <p>'+a.rbmLabel[J]+"</p>\n                </div>\n            ")}}function showTooltip(e,a,r){$('\n        <div id="tooltip" class="tooltip right in">\n            <div class="tooltip-arrow" style="top: 50%;"></div>\n            <div class="tooltip-inner">'+r+"</div>\n        </div>\n    ").css({display:"block",top:a,left:e}).appendTo("body").fadeIn(200)}var timeLoad=performance.now(),timeStartup=void 0;$.getScript("zh"!==navigator.language.substr(0,2).toLowerCase()?"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js":"https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS_SVG-full,Safe&locale=en",function(){timeStartup=performance.now(),console.log("MathJax load takes "+(timeStartup-timeLoad).toFixed(2))});var urlParams={};(window.onpopstate=function(){var e=void 0,a=/\+/g,r=/([^&=]+)=?([^&]*)/g,t=function(e){return decodeURIComponent(e.replace(a," "))},l=window.location.search.substring(1);for(urlParams={};e=r.exec(l);)urlParams[t(e[1])]=t(e[2])})();var $body=$("body");if($body.hasClass("Step1")){for(var $selectType=$("#slType"),i=0;i<typeName.length;i++)$selectType.append('<option value="'+i+'">'+typeName[i]+"</option>");$selectType.selectpicker("val",0).selectpicker("refresh").on("loaded.bs.select",clearTitle).on("changed.bs.select",clearTitle)}if($body.hasClass("Step2")){var type=parseInt(urlParams.Type);(isNaN(type)||5<type||type<0)&&(location.href="Step1.html");var $selectP1=$("#slP1"),$selectP2=$("#slP2"),_$selectType=$("#slType"),$selectP1P2=$("#slP1, #slP2");$("#title")[0].innerHTML+=" <small>"+typeName[type]+"</small>";var $dataTables=$("#dataTables");$dataTables.find(".type"+type).removeClass("hidden");for(var _i=0;_i<6;_i++)_i!==type&&$dataTables.find(".type"+_i+".hidden").remove();for(var _i2=0;_i2<p1Name.length;_i2++){if(3<=type){var threshold=3===type?8:2;if(threshold<=_i2)break}$selectP1P2.append('<option value="'+_i2+'">'+p1Name[_i2]+"</option>")}for(var _i3=0;_i3<typeName.length;_i3++)_$selectType.append('<option value="'+_i3+'">'+typeName[_i3]+"</option>");if(["P1","P2","Val1","Val2","RBM"].every(function(e){return void 0!==urlParams[e]})){var params={p1:parseInt(urlParams.P1),p2:parseInt(urlParams.P2),val1:urlParams.Val1,val2:urlParams.Val2,rbm:urlParams.RBM},valueBetween=function(e,a,r){return a<=e&&e<=r},val1_=parseFloat(params.val1),val2_=parseFloat(params.val2),rbm_=parseFloat(params.rbm),emptyNum=Number(isNaN(val1_))+Number(isNaN(val2_))+Number(isNaN(rbm_));(2<=emptyNum||isNaN(params.p1)||isNaN(params.p2)||!isNaN(val1_)&&!valueBetween(val1_,0,4)||!isNaN(val2_)&&!valueBetween(val2_,0,4)||!isNaN(rbm_)&&!valueBetween(rbm_,30,500)||!valueBetween(params.p1,0,11)||!valueBetween(params.p2,0,11))&&(location.href="Step1.html"),$selectP1.selectpicker("val",params.p1),$selectP2.selectpicker("val",params.p2),$("#edVal1").val(params.val1),$("#edVal2").val(params.val2),$("#edRBM").val(params.rbm)}else["P1","P2","Val1","Val2","RBM"].every(function(e){return void 0!==urlParams[e]})&&(location.href="Step1.html");_$selectType.selectpicker("val",type),$(".selectpicker").selectpicker("refresh"),$("select").on("loaded.bs.select",clearTitle),$selectP1.on("changed.bs.select",function(e,a){console.log("changed fired");var r=a-1;clearTitle(),$selectP2.find("option").each(function(){var e=parseInt($(this).val());(r%2==0&&e===r+1||r%2==1&&e===r-1)&&$selectP2.selectpicker("val",e)}),$(".selectpicker").selectpicker("refresh")})}if($body.hasClass("Step3")){["Type","P1","P2","Val1","Val2","RBM"].every(function(e){return void 0!==urlParams[e]})||(location.href="Step1.html");var inputParams={type:parseInt(urlParams.Type),p1:parseInt(urlParams.P1),p2:parseInt(urlParams.P2),val1:urlParams.Val1,val2:urlParams.Val2,rbm:urlParams.RBM},_valueBetween=function(e,a,r){return a<=e&&e<=r},_val1_=parseFloat(inputParams.val1),_val2_=parseFloat(inputParams.val2),_rbm_=parseFloat(inputParams.rbm),_emptyNum=Number(isNaN(_val1_))+Number(isNaN(_val2_))+Number(isNaN(_rbm_));!(2<=_emptyNum||isNaN(inputParams.type)||isNaN(inputParams.p1)||isNaN(inputParams.p2)||!isNaN(_val1_)&&!_valueBetween(_val1_,0,4)||!isNaN(_val2_)&&!_valueBetween(_val2_,0,4)||!isNaN(_rbm_)&&!_valueBetween(_rbm_,30,500))&&_valueBetween(inputParams.type,0,5)&&_valueBetween(inputParams.p1,0,11)&&_valueBetween(inputParams.p2,0,11)||(location.href="Step1.html"),$("#title")[0].innerHTML+=" <small>"+typeName[inputParams.type]+"</small>";var plotParams=processOutput(getPlotParams(inputParams));$("#resultDiv").addClass(plotParams.ar!==AssignResult.error?"alert-success":"alert-danger").html(plotParams.resultString),$("#yAxisLabel").html(plotParams.yAxisLabel),$("#xAxisLabel").html(plotParams.xAxisLabel),$("#"+plotParams.pointType+"Legend").css("display",""),null!==plotParams.bluePoint&&$("#blueLegend").css("display",""),$(drawPlot("plot-placeholder",plotParams))}function clearTitle(){$(".bootstrap-select").find("button").removeAttr("title")}function validate(a){var r=$("#hint"),e=function(e){return r.addClass("alert-danger").html('<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span> '+e),!1},t=parseFloat(a.Val1.value),l=parseFloat(a.Val2.value),n=parseInt(a.RBM.value);return 2<=Number(isNaN(t))+Number(isNaN(l))+Number(isNaN(n))?e("At least 2 values are required."):!isNaN(t)&&(t<0||4<t)||!isNaN(l)&&(l<0||4<l)||!isNaN(n)&&(n<30||500<n)?e("Please input valid value."):""===$("#slP1").selectpicker("val")?e("Please select the type of transition energy."):($(".selectpicker").removeAttr("disabled"),history.replaceState(null,null,"Step2.html?"+["Type","P1","Val1","P2","Val2","RBM"].map(function(e){return e+"="+a[e].value}).join("&")),!0)}function changeEdit(e,a,r){$("#slP1").selectpicker("val",e),$("#slP2").selectpicker("val",e+1),$("#edVal1").val(a),$("#edVal2").val(r)}function calculate(e){var a=$("#calculatorHint"),r=$("#calcResult"),t=function(){a.html('\n      <div class="alert-danger hint">\n        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>\n        No valid result.\n      </div>\n    '),r.html("")},l=parseInt(e.NCalc.value),n=parseInt(e.MCalc.value),s=parseInt(urlParams.Type);if(l<n){var i=[n,l];l=i[0],n=i[1]}if(isNaN(l)||isNaN(n)||l<=6||n<0||seriesThreshold<2*l+n)return t(),!1;a.html("");var o=$("<tbody></tbody>"),p=$("<div></div>");r.html("").append($('<table class="table table-striped math" id="calcResultList"></table>').append(o)).append(p),o.append("<tr><td>\\(d_t\\)</td><td>\\( "+Dt(l,n,s).toFixed(3).toString()+" \\ \\mathrm{nm}\\)</td></tr>"),generateRBMCalculationResult(l,n,s,o);for(var u=new Array(12),m=0;m<12;m++)if(isMetal(p1ToP(m))===isMetal(l,n))try{u[m]=getEnergy(Dt(l,n,s),Theta(l,n),p1ToP(m),s,isMetal(l,n)?m%2-1:Mod(l,n)).toFixed(3).toString()}catch(e){u[m]=-1}else u[m]=-1;for(var c=0,h=function(e){if(-1===u[e]||-1===u[e+1])return"continue";c++,o.append($("<tr><td>"+p1Name[e]+"</td><td>\\("+u[e]+"\\ \\mathrm{eV}\\)</td></tr>").click(function(){return changeEdit(e,u[e],u[e+1])}).css("cursor","pointer")).append($("<tr><td>"+p1Name[e+1]+"</td><td>\\("+u[e+1]+"\\ \\mathrm{eV}\\)</td></tr>").click(function(){return changeEdit(e,u[e],u[e+1])}).css("cursor","pointer"));var a=processOutput(getPlotParams({type:s,p1:e,p2:e+1,val1:u[e],val2:u[e+1],rbm:""})),r="calcPlot"+Math.round(e/2),t=$('\n      <div class="math calc-plot-container" \n           oncontextmenu="return false" onmousedown="return false">\n        <div class="row">\n          <div class="col-lg-offset-2 col-md-offset-6 rbmAxisLabel">\n            \\(\\omega_{\\mathrm{RBM}}\\ (\\mathrm{cm^{-1}})\\)\n          </div>\n        </div>\n        <br />\n        <div class="row" style="position: relative;">\n          <div class="yAxisLabel">'+a.yAxisLabel+'</div>\n          <div id="'+r+'" style="width: 400px; height: 290px; font-family: \'Times New Roman\', serif;"\n               class="col-md-offset-1 col-xs-offset-1"></div>\n        </div>\n        <div class="row">\n          <div class="col-lg-offset-2 col-md-offset-5 xAxisLabel">\n               '+a.xAxisLabel+"\n          </div>\n        </div>\n      </div>\n    ");p.append(t),drawPlot(r,a)},d=0;d<12;d+=2)h(d);return 0===c&&t(),MathJax.Hub.Queue(["Typeset",MathJax.Hub]),!1}function generateRBMCalculationResult(e,a,r,t){var l=0===r,n=function(e){return $("#edRBM").val(e)};if(l){var s=dt2RBM(Dt(e,a,r),isMetal(e,a)?2:0,r).toFixed(1).toString();t.append($("\n        <tr>\n            <td>\\(\\omega_\\mathrm{RBM}\\ "+(isMetal(e,a)?"(p=3)":"(p=1,2)")+" \\)</td>\n            <td>\\( "+s+" \\ \\mathrm{cm^{-1}}\\)</td>\n        </tr>\n      ").click(function(){return n(s)}).css("cursor","pointer"))}var i=dt2RBM(Dt(e,a,r),l?3:0,r).toFixed(1).toString();t.append($("\n      <tr>\n          <td>\\(\\omega_\\mathrm{RBM}\\ "+(l?"(p>3)":"")+" \\)</td>\n          <td>\\( "+i+" \\ \\mathrm{cm^{-1}}\\)</td>\n      </tr>\n    ").click(function(){return n(i)}).css("cursor","pointer"))}
//# sourceMappingURL=app.min.js.map
