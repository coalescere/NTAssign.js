<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-compatible" content="IE=edge, chrome=1">
    <link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <title>Step 3</title>
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/bootstrap-select.min.css" rel="stylesheet" />
    <link href="css/site.css" rel="stylesheet" />

    <script src="js/lib/jquery-3.3.1.min.js"></script>
    <script src="js/lib/bootstrap.min.js"></script>
    <script src="js/lib/bootstrap-select.min.js"></script>
    <script src="js/lib/modernizr-2.8.3.js"></script>
    <script src="js/lib/respond.min.js"></script>
    <script src="js/lib/flot/jquery.flot.min.js"></script>
    <script src="js/lib/flot/jquery.flot.fillbetween.min.js"></script>
    <script src="js/lib/flot/jquery.flot.symbol.min.js"></script>
    <script src="js/lib/linq.min.js"></script>
    <script src="js/lib/es-checker.js"></script>

</head>
<body>
<div class="container body-content">
    <a href="http://old.chem.pku.edu.cn/liy/labhomepage" target="_blank">
        <img src="img/banner_waifu2x.png" style="width: 75%;" class="center-block" />
    </a>

    <!-- start content -->

    <div id="es6Dimmer" class="modal fade" role="dialog" style="top: 30%;" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <h3 style="text-align: center;">
                        Your browser doesn't support ECMAScript 6 (ES2015), and the program can't work properly.
                        <br /><br /> IE-based browsers are deprecated now.
                        Using Edge, Chrome, Firefox will be better.
                    </h3>
                </div>
                <div class="modal-footer">
                    <a type="button" href="https://www.google.com/chrome/" class="btn btn-primary" >
                        Download Chrome
                    </a>
                    <a type="button" href="https://www.firefox.com.cn/" class="btn btn-primary" >
                        Download Firefox
                    </a>
                </div>
            </div>
        </div>
    </div>

    <h1 id="title" class="math">
        Step 3
    </h1>
    <hr />
    <h2 class="math">Results</h2>
    <div id="body-container">
        <div class="row">
            <!-- the plot -->
            <div class="col-md-6 col-xs-12 math" oncontextmenu="return false" onmousedown="return false">
                <div class="row">
                    <div class="col-lg-offset-2 col-md-offset-6" style="text-align: center;
                    font-size: 20px; color: #0000FF">
                        \(\omega_{\mathrm{RBM}}\ (\mathrm{cm^{-1}})\)
                    </div>
                </div>
                <br />
                <div id="plot-container" class="row" style="position: relative;">
                    <div>
                        <div id="yAxisLabel" style="position: absolute; top: 70%; left: 2%; font-size: 20px;
                        transform: rotate(-90deg); transform-origin: top left;">
                        </div>
                    </div>
                    <div id="plot-placeholder" style="width: 550px; height: 400px; font-family: serif;"
                         class="col-md-offset-1 col-xs-offset-1"></div>
                </div>
                <div class="row">
                    <div id="xAxisLabel" class="col-lg-offset-2 col-md-offset-5"
                         style="text-align: center; font-size: 20px; color: #FF0000">
                    </div>
                </div>
            </div>
            <!-- end of plot -->

            <div class="col-lg-5 col-md-4 col-xs-8 col-lg-offset-0_5 col-md-offset-1_5
            col-xs-offset-1 math changing_height">
                <br />
                <br />
                <p id="resultDiv" class="text-center" style="padding: 12px; border-radius: 4px; font-size: 24px;">
                </p>
                <div style="font-size: 18px; border-radius: 4px; border: 2px solid #808080;" class="bottom-div clearfix">

                    <p id="greenLegend" style="display: none;">
                        <span style="color: rgb(12, 180, 15);">&#11046;</span> \(E_{ii}\) vs. \(\omega_\mathrm{RBM}\)
                    </p>
                    <p id="redLegend" style="display: none;">
                        <span style="color: rgb(255, 0, 0); font-weight: 900;">&#9632;</span>
                        \(E_{ii}\) difference vs. \(E_{ii}\) average
                    </p>
                    <p id="blueLegend" style="display: none;">
                        <span style="color: rgb(0, 0, 255); font-weight: 900;">&#11046;</span>
                        \(E_{ii}\) difference vs. \(\omega_\mathrm{RBM}\)
                    </p>
                    <p><span style="color: rgb(12, 127, 15); font-weight: 900;">&mdash;</span>
                        \(532\ \mathrm{nm}\) laser (\(2.33\ \mathrm{eV}\))
                    </p>
                    <p><span style="color: rgb(245, 0, 0); font-weight: 900;">&mdash;</span>
                        \(633\ \mathrm{nm}\) laser (\(1.96\ \mathrm{eV}\))
                    </p>
                    <p><span style="color: rgb(136, 136, 136); font-weight: 900;">&mdash;</span>
                        \(785\ \mathrm{nm}\) laser (\(1.58\ \mathrm{eV}\))
                    </p>
                    <p>
                        Laser resonance window: \(\pm100\ \mathrm{meV}\)
                    </p>
                </div>
            </div>
        </div>
    </div>


    <!-- end content -->

    <hr />
    <footer>
        <p>&copy; 2009&ndash;2018 Nanomaterials & Nanostructures Group, Peking University. All rights reserved.</p>
        <p>
            Please contact <b>Prof. Juan Yang, yang_juan(at)pku.edu.cn</b> for any scientific issues.<br />
            Please contact <b>Sida Sun, accel(at)pku.edu.cn</b>
            <a href="https://github.com/visualer">(site developer)</a>  for any technical assistance.
        </p>
        <p><br /></p>
        <div align='center'>
            <a href='http://www.hit-counts.com'>
                <img src='http://www.hit-counts.com/counter.php?t=MTQxNzMzNQ==' border='0' alt='Web Counter'>
            </a><BR><a href='http://www.hit-counts.com'>Web Counter</a></div>
    </footer>
</div>

<script>
    $.getScript(navigator.language.substr(0, 2).toLowerCase() !== "zh"
        ? "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js"
        : "https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js"
        + "?config=TeX-AMS_SVG-full,Safe&locale=en"
    );
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        showProcessingMessages: false,
        showMathMenu: false,
        messageStyle: "none",
        tex2jax: {
            processEscapes: true,
            preview: "none"
        }
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        $(".math").removeClass("math");
    });
    MathJax.Hub.Register.MessageHook("New Math", function () {
        $(".math").removeClass("math");
    });
</script>

<script src="js/Energy.js"></script>
<script src="js/Assign.js"></script>
<script src="js/main.js"></script>
<script src="js/Plot.js"></script>

<!-- script -->
<script>

    // check integrity
    for (let i of ['Type', 'P1', 'P2', 'Val1', 'Val2', 'RBM']) {
        if (urlParams[i] === undefined) {
            location.href = 'Step1.html';
            break;
        }
    }

    let params = {
        type: parseInt(urlParams['Type']), // int
        p1: parseInt(urlParams['P1']), // int
        p2: parseInt(urlParams['P2']), // int
        val1: urlParams['Val1'], // empty-able str
        val2: urlParams['Val2'], // empty-able str
        rbm: urlParams['RBM'] // empty-able str
    };

    let valueBetween = (xy, a, b) => (xy >= a || xy <= b);
    let val1_ = parseFloat(params.val1), val2_ = parseFloat(params.val2), rbm_ = parseFloat(params.rbm);
    let emptyNum = Number(isNaN(val1_)) + Number(isNaN(val2_)) + Number(isNaN(rbm_));
    if (emptyNum >= 2 || isNaN(params.type) || isNaN(params.p1) || isNaN(params.p2) ||
        !isNaN(val1_) && (val1_ < 0 || val1_ > 4) || !isNaN(val2_) && (val2_ < 0 || val2_ > 4) ||
        !isNaN(rbm_) && (rbm_ < 30 || rbm_ > 500) || !valueBetween(params.type, 0, 5) ||
        !valueBetween(params.p1, 0, 11) || !valueBetween(params.p2, 0, 11)
    )
        location.href = 'Step1.html';

    // end validation

    $("#title")[0].innerHTML += '<small>' + typeArr[params.type] + '</small>';

    let plotParams = processOutput(getPlotParams(params));

    $("#resultDiv")
        .addClass(plotParams.ar !== AssignResult.error ? "alert-success" : "alert-danger")
        .html(plotParams.resultString);
    $("#yAxisLabel").html(plotParams.yAxisLabel);
    $("#xAxisLabel").html(plotParams.xAxisLabel);
    $("#" + plotParams.pointType + "Legend").css("display", "");
    if (plotParams.bluePoint !== null)
        $("#blueLegend").css("display", "");

    $(drawPlot("plot-placeholder", plotParams));


</script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107272975-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments) }
    gtag('js', new Date());

    gtag('config', 'UA-107272975-1');
</script>
</body>
</html>
